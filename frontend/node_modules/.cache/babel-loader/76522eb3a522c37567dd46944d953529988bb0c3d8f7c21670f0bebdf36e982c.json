{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{useNavigate}from\"react-router-dom\";import{AuthContext}from\"../context/AuthContext\";import NoteList from\"../components/NoteList\";import NoteForm from\"../components/NoteForm\";import{getNotes}from\"../api\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const NotesPage=()=>{const{isAuthenticated,logout}=useContext(AuthContext);const navigate=useNavigate();const[notes,setNotes]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(\"\");useEffect(()=>{// Redirect to login if not authenticated\nif(!isAuthenticated){navigate(\"/\");return;}// Fetch notes\nfetchNotes();},[isAuthenticated,navigate]);const fetchNotes=async()=>{try{setLoading(true);const fetchedNotes=await getNotes();setNotes(fetchedNotes);setError(\"\");// Clear any previous errors\n}catch(err){// Only set error if it's a real error, not just empty notes\nif(err.response&&err.response.status===401){// Handle auth error\nsetError(\"Authentication error. Please try logging in again.\");logout();navigate(\"/\");}else{setError(\"Failed to load notes\");}}finally{setLoading(false);}};const handleLogout=()=>{logout();navigate(\"/\");};if(!isAuthenticated){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:\"notes-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"SecureNotes\"}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-button\",onClick:handleLogout,children:\"Logout\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading notes...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(NoteForm,{onNoteAdded:fetchNotes}),/*#__PURE__*/_jsx(NoteList,{notes:notes})]})]});};export default NotesPage;","map":{"version":3,"names":["React","useContext","useEffect","useState","useNavigate","AuthContext","NoteList","NoteForm","getNotes","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NotesPage","isAuthenticated","logout","navigate","notes","setNotes","loading","setLoading","error","setError","fetchNotes","fetchedNotes","err","response","status","handleLogout","className","children","onClick","onNoteAdded"],"sources":["/Users/khatirakazemi/Documents/GitHub/SecureNotes/frontend/src/pages/NotesPage.tsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AuthContext } from \"../context/AuthContext\";\nimport NoteList from \"../components/NoteList\";\nimport NoteForm from \"../components/NoteForm\";\nimport { getNotes } from \"../api\";\nimport { Note } from \"../types\";\n\nconst NotesPage: React.FC = () => {\n  const { isAuthenticated, logout } = useContext(AuthContext);\n  const navigate = useNavigate();\n  const [notes, setNotes] = useState<Note[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    // Redirect to login if not authenticated\n    if (!isAuthenticated) {\n      navigate(\"/\");\n      return;\n    }\n\n    // Fetch notes\n    fetchNotes();\n  }, [isAuthenticated, navigate]);\n\n  const fetchNotes = async () => {\n    try {\n      setLoading(true);\n      const fetchedNotes = await getNotes();\n      setNotes(fetchedNotes);\n      setError(\"\"); // Clear any previous errors\n    } catch (err: any) {\n      // Only set error if it's a real error, not just empty notes\n      if (err.response && err.response.status === 401) {\n        // Handle auth error\n        setError(\"Authentication error. Please try logging in again.\");\n        logout();\n        navigate(\"/\");\n      } else {\n        setError(\"Failed to load notes\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleLogout = () => {\n    logout();\n    navigate(\"/\");\n  };\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <div className=\"notes-page\">\n      <div className=\"header\">\n        <h1>SecureNotes</h1>\n        <button className=\"logout-button\" onClick={handleLogout}>\n          Logout\n        </button>\n      </div>\n\n      {error && <div className=\"error\">{error}</div>}\n\n      {loading ? (\n        <p>Loading notes...</p>\n      ) : (\n        <>\n          <NoteForm onNoteAdded={fetchNotes} />\n          <NoteList notes={notes} />\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default NotesPage;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}